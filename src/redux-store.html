<link rel="import" href="/bower_components/polymer-redux/polymer-redux.html">

<script>
  const initialState = {
    speakers: []
  };

  const reducer = (state, action) => {
    if (!state) return initialState;

    switch (action.type) {
      case 'FETCH_SPEAKERS':
        const speakers = Object.keys(action.data)
          .map(key => Object.assign({}, action.data[key], { $key: key }) );

        return Object.assign({}, state, { speakers });
    }
  };

  const store = Redux.createStore(reducer);
  const ReduxMixin = PolymerRedux(store);

  firebase.database().ref('/speakers').on('value', snapshot => {
    store.dispatch({
      type: 'FETCH_SPEAKERS',
      data: snapshot.val()
    });
  });
</script>
